"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[72587],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,m=c(e,["components","mdxType","originalType","parentName"]),d=l(n),u=r,h=d["".concat(s,".").concat(u)]||d[u]||p[u]||o;return n?a.createElement(h,i(i({ref:t},m),{},{components:n})):a.createElement(h,i({ref:t},m))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},65970:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const o={description:"Compatibility between the ISC EVM layer and existing Ethereum smart contracts and tooling.",image:"/img/logo/WASP_logo_dark.png",keywords:["smart contracts","EVM","Ethereum","Solidity","limitations","compatibility","fees","reference"]},i="EVM Compatibility in IOTA Smart Contracts",c={unversionedId:"guide/evm/compatibility",id:"guide/evm/compatibility",title:"EVM Compatibility in IOTA Smart Contracts",description:"Compatibility between the ISC EVM layer and existing Ethereum smart contracts and tooling.",source:"@site/next/external/wasp/documentation/docs/guide/evm/compatibility.md",sourceDirName:"guide/evm",slug:"/guide/evm/compatibility",permalink:"/next/smart-contracts/guide/evm/compatibility",draft:!1,editUrl:"https://github.com/iotaledger/wasp/edit/develop/documentation/next/external/wasp/documentation/docs/guide/evm/compatibility.md",tags:[],version:"current",frontMatter:{description:"Compatibility between the ISC EVM layer and existing Ethereum smart contracts and tooling.",image:"/img/logo/WASP_logo_dark.png",keywords:["smart contracts","EVM","Ethereum","Solidity","limitations","compatibility","fees","reference"]},sidebar:"tutorialSidebar",previous:{title:"EVM/Solidity Based Smart Contracts",permalink:"/next/smart-contracts/guide/evm/introduction"},next:{title:"How to use EVM in IOTA Smart Contracts",permalink:"/next/smart-contracts/guide/evm/using"}},s={},l=[],m={toc:l};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"evm-compatibility-in-iota-smart-contracts"},"EVM Compatibility in IOTA Smart Contracts"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/core_contracts/evm"},(0,r.kt)("inlineCode",{parentName:"a"},"evm"))," ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/core_contracts/overview"},"core contract"),"\nprovides EVM support in IOTA Smart Contracts. It stores the EVM state (account balances, state, code,\netc.) and provides a way to execute EVM code to manipulate the state."),(0,r.kt)("p",null,"The EVM core contract runs on top of the ISC layer, which provides the rest of the machinery needed to run smart\ncontracts, such as signed requests, blocks, state, proofs, etc."),(0,r.kt)("p",null,"However, the ISC EVM layer is also designed to be as compatible as possible with existing Ethereum tools\nlike ",(0,r.kt)("a",{parentName:"p",href:"https://metamask.io/"},"MetaMask"),", which assume that the EVM code runs on an Ethereum blockchain composed of\nEthereum blocks containing Ethereum transactions. Since ISC works in a fundamentally different way,\nproviding 100% compatibility is not possible. We do our best to emulate the behavior of an Ethereum node, so the\nEthereum tools think they are interfacing with an actual Ethereum node, but some differences in behavior are inevitable."),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"There is a difference in the decimal precision of ether (18 decimal places) to MIOTA/SMR(6 decimal places). Because of this, when sending native tokens in the EVM, which are expressed in wei (ether = 10",(0,r.kt)("sup",null,"18"),"wei), the last 12 decimal places will be ignored."),(0,r.kt)("p",{parentName:"admonition"},"example: 1,999,999,999,999,999,999 wei = 1.999,999 SMR/MIOTA")),(0,r.kt)("p",null,"Here are some of the most important properties and limitations of EVM support in IOTA Smart Contracts:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The Wasp node provides a JSON-RPC service, the standard protocol used by Ethereum tools. Upon receiving a signed\nEthereum transaction via JSON-RPC, the transaction is wrapped into an ISC off-ledger request. The sender of the\nrequest\nis the Ethereum address that signed the original transaction (e.g., the Metamask account).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"While ISC contracts are identified by an ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/smart-contract-anatomy"},"hname"),", EVM contracts are\nidentified by their Ethereum address.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"EVM contracts are not listed in the chain's ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/core_contracts/root"},"contract registry"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"EVM contracts cannot be called via regular ISC requests; they can only be\ncalled through the JSON-RPC service.\nAs a consequence, EVM contracts cannot receive on-ledger requests.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"In contrast with an Ethereum blockchain, which stores the state in a Merkle tree, the EVM state is stored in raw form.\nIt would be inefficient to do that since it would be duplicating work done by the ISC layer.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Any Ethereum transactions present in an ISC block are executed by\nthe ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/core_contracts/evm"},(0,r.kt)("inlineCode",{parentName:"a"},"evm"))," ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/core_concepts/core_contracts/overview"},"core contract"),",\nupdating the EVM state accordingly. An emulated Ethereum block is also created and stored to provide compatibility\nwith EVM tools. As the emulated block is not part of a real Ethereum blockchain, some attributes of the blocks will\ncontain dummy values (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"stateRoot"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce"),", etc.).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Each stored block contains the executed Ethereum transactions and corresponding Ethereum receipts. If storage is\nlimited, you can configure EVM so that only the latest N blocks are stored.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"There is no guaranteed ",(0,r.kt)("em",{parentName:"p"},"block time"),'. A new EVM "block" will be created only when an ISC block is created, and ISC does\nnot enforce an average block time.')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Any Ethereum address is accepted as a valid ",(0,r.kt)("inlineCode",{parentName:"p"},"AgentID"),", and thus can own L2 tokens on an IOTA Smart Contract chain,\njust like IOTA addresses.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The Ethereum balance of an account is tied to its L2 ISC balance in the token used to pay for gas. For example,\nby default ",(0,r.kt)("inlineCode",{parentName:"p"},"eth_getBalance")," will return the L2 base token balance of the given Ethereum account."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"To manipulate the owned ISC tokens and access ISC functionality in general, there is\na ",(0,r.kt)("a",{parentName:"p",href:"/next/smart-contracts/guide/evm/magic"},"special Ethereum contract")," that provides bindings to the ISC sandbox (e.g. call ",(0,r.kt)("inlineCode",{parentName:"p"},"isc.send(...)")," to send\ntokens).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The used EVM gas is converted to ISC gas before being charged to the sender. The conversion ratio is configurable. The\ntoken used to pay for gas is the same token configured in the ISC chain (IOTA by default). The gas fee is debited from\nthe sender's L2 account and must be deposited beforehand."))))}p.isMDXComponent=!0}}]);