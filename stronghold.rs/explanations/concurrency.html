<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-stronghold-rs docs-doc-id-explanations/concurrency">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Concurrency in Stronghold | IOTA Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wiki.iota.org/stronghold.rs/explanations/concurrency"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-stronghold-rs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-stronghold-rs-current"><meta data-rh="true" property="og:title" content="Concurrency in Stronghold | IOTA Wiki"><meta data-rh="true" name="description" content="Learn about Stronghold as a concurrent software, the actor model STM with TL2 and RLU."><meta data-rh="true" property="og:description" content="Learn about Stronghold as a concurrent software, the actor model STM with TL2 and RLU."><meta data-rh="true" name="keywords" content="actor model,rlu,STM,concurrency,lockless,explanation"><meta data-rh="true" property="og:image" content="https://wiki.iota.org/img/logo/Stronghold_icon.png"><meta data-rh="true" name="twitter:image" content="https://wiki.iota.org/img/logo/Stronghold_icon.png"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wiki.iota.org/stronghold.rs/explanations/concurrency"><link data-rh="true" rel="alternate" href="https://wiki.iota.org/stronghold.rs/explanations/concurrency" hreflang="en"><link data-rh="true" rel="alternate" href="https://wiki.iota.org/stronghold.rs/explanations/concurrency" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YTLE56KAO4-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="IOTA Wiki" href="/opensearch.xml">







































<link rel="preconnect" href="https://matomo.iota-community.org/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://matomo.iota-community.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","13"]);var t=document,e=t.createElement("script"),p=t.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src=a+"matomo.js",p.parentNode.insertBefore(e,p)}()</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c0cf84a3.css">
<link rel="preload" href="/assets/js/runtime~main.000c6006.js" as="script">
<link rel="preload" href="/assets/js/main.111cab16.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#5991c7;color:#ffffff" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you would like to get more involved in the future governance of Shimmer, IOTA, and the Assembly network, join the discussions with the community in our <a target="_blank" href="https://govern.iota.org">governance forum</a> üèõÔ∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="IOTA Wiki Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.svg" alt="IOTA Wiki Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/use/wallets/what-is-a-wallet">Use IOTA</a><a class="navbar__item navbar__link" href="/learn/about-iota/an-introduction-to-iota">Learn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/develop/welcome">Develop</a><a class="navbar__item navbar__link" href="/community/the-community/discord">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable network-dropdown dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">IOTA</a><ul class="dropdown__menu"><li><a class="dropdown__link network-dropdown__link" href="/shimmer/stronghold.rs/explanations/concurrency" data-reactroot=""><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" class="network-dropdown__icon"><path d="M34.55 14.045a12.973 12.973 0 0 0-18.576-.255c-5.2 5.152-5.311 13.62-.25 18.912l3.327-3.297c-3.265-3.434-3.186-8.911.18-12.246a8.352 8.352 0 0 1 2.77-1.838 8.433 8.433 0 0 1 6.537.079 8.343 8.343 0 0 1 2.723 1.904l3.29-3.259Zm-22.1 21.91a12.973 12.973 0 0 0 18.576.255c5.2-5.152 5.311-13.62.25-18.912l-3.327 3.297c3.264 3.433 3.186 8.911-.18 12.246a8.351 8.351 0 0 1-2.77 1.838 8.435 8.435 0 0 1-6.538-.079 8.345 8.345 0 0 1-2.723-1.904l-3.288 3.259Z" class="icon-color-primary"></path></svg>Shimmer</a></li><li><a class="dropdown__link network-dropdown__link" href="/next/stronghold.rs/explanations/concurrency" data-reactroot=""><svg viewBox="0 0 84 84" fill="none" xmlns="http://www.w3.org/2000/svg" class="network-dropdown__icon"><path d="M66.789 58.65c1.305 1.917 1.555 3.56.751 4.927-.803 1.368-2.44 2.052-4.91 2.052H22.37c-2.47 0-4.107-.684-4.91-2.052-.804-1.368-.554-3.01.751-4.927L35.79 33.028V20.136h-2.237c-.605 0-1.13-.205-1.572-.614-.443-.41-.664-.894-.664-1.454 0-.56.22-1.045.664-1.454.442-.41.966-.614 1.572-.614h17.894c.605 0 1.13.204 1.572.614.443.409.664.894.664 1.454 0 .56-.22 1.044-.664 1.454a2.237 2.237 0 0 1-1.572.614H49.21v12.892L66.789 58.65ZM39.564 35.225l-9.506 13.86h24.884l-9.506-13.86-.7-1.002V20.136h-4.473v14.087l-.699 1.002Z"></path></svg>Next</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="IOTA Wiki Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.svg" alt="IOTA Wiki Logo" class="themedImage_ToTc themedImage--dark_i4oU"></a><nav class="menu thin-scrollbar menu_Y1UP menuWithAnnouncementBar_fPny"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/stronghold.rs/welcome">Welcome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/stronghold.rs/getting_started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/stronghold.rs/explanations/non-contiguous-data-types">Explanations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stronghold.rs/explanations/non-contiguous-data-types">Non-contiguous Data Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stronghold.rs/explanations/procedures">Cryptographic Procedures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stronghold.rs/explanations/runtime-extensions">Runtime Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/stronghold.rs/explanations/concurrency">Concurrency in Stronghold</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stronghold.rs/explanations/deadlock-analysis">Deadlock Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/stronghold.rs/explanations/retrospective">Retrospective</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/stronghold.rs/how_tos/cli/running_examples">How Tos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/stronghold.rs/reference/overview">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/stronghold.rs/contribute">Contribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/iotaledger/stronghold.rs" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Explanations</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Concurrency in Stronghold</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Concurrency in Stronghold</h1><p>Writing software that runs on CPUs with more than one core is the norm nowadays. Software libraries heavily use concurrent code, separating sequential steps of work into concurrent, possibly parallel, work packages.</p><p>Writing concurrent programs makes the most of our current computers and servers in terms of performance. The downside of this approach is that it is difficult to write such programs without having bugs. This is mostly due to a problem called <em>data race</em>, where multiple threads simultaneously tamper with the same shared memory, which may create inconsistent behavior of the concurrent program because each thread executes its computations in a non-deterministic order.</p><p>Multiple solutions to tackle concurrent programming exist, and we have been exploring them for Stronghold.
In the following sections, we will present different solutions tested to make Stronghold a concurrent library.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-actor-model">The Actor Model<a class="hash-link" href="#the-actor-model" title="Direct link to heading">‚Äã</a></h2><p>Stronghold employed a well-known concurrency architecture: the actor model. The basic idea of the actor model is to have isolated actors, each taking care of some functionality. Actors receive messages with data to act upon and return data when they finish processing it. Since each actor contains its own state and concurrency is achieved by not directly calling functions, but by polling messages, most undesirable concurrency problems are taken care of. Deadlocks will never occur.</p><p>The actor system is almost ubiquitous in the target architecture. Many modern languages have a built-in actor model with an excellent supervisor, among other tools. With Rust, the integration involves a lot of boilerplate code. But it‚Äôs for each user to decide whether or not the actor model approach is favorable. We wanted to know whether we could provide a simple interface, ideally some primitive types to work on with simple function calls, but still run in a concurrent setup without the headaches that come with locks and mutexes.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="why-didnt-we-keep-the-actor-model">Why didn&#x27;t we keep the actor model?<a class="hash-link" href="#why-didnt-we-keep-the-actor-model" title="Direct link to heading">‚Äã</a></h3><p>The first iteration of Stronghold implemented the actor model with the rust crate <a href="https://riker.rs/" target="_blank" rel="noopener noreferrer">Riker</a>, an actor system crate.</p><p>Unfortunately, since this crate was discontinued, we had to find an alternative: the <a href="https://github.com/actix/actix" target="_blank" rel="noopener noreferrer">Actix</a> actor framework crate.
Actix uses the Tokio runtime, which came as an issue for us as the Stronghold library.</p><p>Software using Stronghold had to pass ownership of the runtime to our code when making function calls to the Stronghold library.
This was cumbersome for our users, and we abandoned the idea of using the actor model for concurrent programming and explored other paradigms.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="software-transactional-memory-stm-with-transactional-locking-2-tl2">Software Transactional Memory (STM) with Transactional Locking 2 (TL2)<a class="hash-link" href="#software-transactional-memory-stm-with-transactional-locking-2-tl2" title="Direct link to heading">‚Äã</a></h2><p>STMs have been around for quite some time. In STMs, each operation on memory happens in an atomic transaction. Whenever memory is modified, this modification is written into a log. While inside a transaction, reading from memory is also done through a log. The transaction has finished when all changes recorded inside the log have been committed to the actual memory. A transaction fails if another thread tries to modify the targeted piece of memory between operations. A failed transaction can be re-run any number of times.</p><p>This approach guarantees that modifications to memory are always consistent, but it comes with a restriction. Since transactions can be retried, operations inside a transaction must be idempotent and should not have any side effects. In an extreme case, think of a function that launches an ICMB: you can not reverse the process. Another edge case concerning STM-based approaches is interleaving transactions, where reads and writes are alternating between two threads. In a worst-case scenario, both transactions would retry indefinitely.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tl2">TL2<a class="hash-link" href="#tl2" title="Direct link to heading">‚Äã</a></h3><p>The Implementation of TL2 is inspired by these papers:</p><ul><li><a href="https://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.90.811&amp;rank=4&amp;q=various%20cross%20version%20operation&amp;osm=&amp;ossid=" target="_blank" rel="noopener noreferrer">Transactional Locking II (2006)</a></li><li><a href="https://www.researchgate.net/publication/220854689_Testing_patterns_for_software_transactional_memory_engines" target="_blank" rel="noopener noreferrer">Testing patterns for software transactional memory engines</a>.</li></ul><p>The idea is quite straightforward. A global clock is used and incremented every time a transaction terminates.
Shared memory/variables are tagged with a local clock value corresponding to the moment they were last modified by a transaction commitment.
Transactions are computed on copies of these shared memory/variables.</p><p>At the end of each transaction, the system needs to check that all the shared memory/variables used during the transaction have not been tampered with by another transaction to keep a consistent behavior.
Stronghold verifies this by checking the local clock of the copies used for the transaction against the local clock of the original shared memory/variables.</p><p>If the check detects any inconsistency between clock values, then the transaction is reset and computed again.</p><p>If the check is successful, the copies are committed and replace the original shared memory/variables, and the global clock also gives them a new local clock value.</p><p>This approach&#x27;s advantage is that the idea is relatively simple and implements the STM model. The downside is that the implementation we developed of TL2 is painfully slow, and usually going single thread is faster than using multiple threads.
We suspect this poor performance is due to multiple interleaving of threads which force the transactions to be reset multiple times. Further investigation is required to confirm this idea.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="read-log-update-rlu">Read-Log-Update (RLU)<a class="hash-link" href="#read-log-update-rlu" title="Direct link to heading">‚Äã</a></h2><p>RLU is an extension of the more famous <em>Read-Copy-Update</em> (RCU) that has been widely adopted in the Linux kernel.</p><p>RLU was first presented in 2015 in the paper <a href="http://sigops.org/sosp/sosp15/current/2015-Monterey/printable/077-matveev.pdf" target="_blank" rel="noopener noreferrer">Read-Log-Update: A Lightweight Synchronization Mechanism for Concurrent Programming</a>. </p><p>Contrary to <a href="#tl2">TL2</a>, RLU is a blocking algorithm.
Threads do their computations locally and synchronize with each other using their local clock (when the computations started) and a common global clock.
A thread logs the new value of any shared memory it has modified.</p><p>To read shared memory, a thread either does it directly in the memory or fetches it in another thread logs when it has been locked and is being modified.
When a thread wants to commit its computations to the memory, it has to wait for all the other threads that have started with an old memory state to terminate.</p><p>The upside to this approach is that a thread never needs to redo its computation since it has to wait for the correct timing to commit its work.</p><p>In return, threads may be idle for some time as they have to wait.
However, the whole RLU algorithm is lock-free. This means that at any moment there is always a thread that advances in its computation, and the whole system cannot be hard-stuck.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="concurrent-programming-with-locks">Concurrent Programming with Locks<a class="hash-link" href="#concurrent-programming-with-locks" title="Direct link to heading">‚Äã</a></h2><p>Using locks is one of the most basic approaches to concurrent programming.
Locks are used for controlling access to shared memory/variables. Depending on the type of locks used, you can restrict access to a shared memory/variable to either one or a limited number of threads.
This prevents data race since the different threads cannot access the shared memory/variables chaotically.
The biggest issue is that those locks are generally difficult to use correctly and hard to debug.</p><p>One of the most problematic situations with locks is a <strong>deadlock</strong>.
Deadlocks happen when the whole system cannot advance anymore because different threads require some locks to advance their computation, but these locks are kept and blocked by other threads in a similar situation.
Models like the <a href="#the-actor-model">actor system</a> or the <a href="#software-transactional-memory-stm-with-transactional-locking-2-tl2">STM</a> use locks as little as possible.</p><p>In our case, Stronghold‚Äôs API is relatively straightforward, so we&#x27;re exploring the idea of using basic locks instead of a resource-heavy concurrent framework.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/iotaledger/stronghold/edit/dev/documentation/docs/explanations/concurrency.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/stronghold.rs/explanations/runtime-extensions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Runtime Extensions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/stronghold.rs/explanations/deadlock-analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deadlock Analysis in Stronghold</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-actor-model" class="table-of-contents__link toc-highlight">The Actor Model</a><ul><li><a href="#why-didnt-we-keep-the-actor-model" class="table-of-contents__link toc-highlight">Why didn&#39;t we keep the actor model?</a></li></ul></li><li><a href="#software-transactional-memory-stm-with-transactional-locking-2-tl2" class="table-of-contents__link toc-highlight">Software Transactional Memory (STM) with Transactional Locking 2 (TL2)</a><ul><li><a href="#tl2" class="table-of-contents__link toc-highlight">TL2</a></li></ul></li><li><a href="#read-log-update-rlu" class="table-of-contents__link toc-highlight">Read-Log-Update (RLU)</a></li><li><a href="#concurrent-programming-with-locks" class="table-of-contents__link toc-highlight">Concurrent Programming with Locks</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Use</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/use/wallets/what-is-a-wallet">Wallets</a></li></ul></div><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/learn/about-iota/an-introduction-to-iota">How It Works</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/iota-token/buying-iota">IOTA Token</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/research/research-outline">Research</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/glossary">Glossary</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/faqs">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Develop</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/develop/nodes/about-nodes">Nodes</a></li><li class="footer__item"><a class="footer__link-item" href="/chronicle/welcome">Chronicle</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials">Tutorials</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/funding/edf-funding">Funding</a></li><li class="footer__item"><a class="footer__link-item" href="/community/the-community/how-to-support">The Community</a></li><li class="footer__item"><a class="footer__link-item" href="/community/research/research-outline">Research</a></li><li class="footer__item"><a class="footer__link-item" href="/community/contribute-to-wiki/welcome">Contribute To Wiki</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.iota.org" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/footer_logo.svg" alt="IOTA Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/footer_logo.svg" alt="IOTA Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">¬© 2022 IOTA Wiki. Built with Docusaurus.</div></div></div></footer><div class="social"><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:var(--ifm-color-gray-900)" href="https://www.youtube.com/c/iotafoundation"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M42.758 9.004A6.013 6.013 0 0 1 47 13.246c1 3.742 1 11.555 1 11.555s0 7.812-1.004 11.554a6.013 6.013 0 0 1-4.242 4.243C39.012 41.602 24 41.602 24 41.602s-15.012 0-18.754-1.004a6.013 6.013 0 0 1-4.242-4.243C0 32.613 0 24.801 0 24.801s0-7.813 1.004-11.555a6.013 6.013 0 0 1 4.242-4.242C8.988 8 24 8 24 8s15.012 0 18.758 1.004ZM31.676 24.8 19.199 32V17.602Zm0 0" fill-rule="evenodd"></path></svg><div class="social__title">Youtube</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#2C3850" href="https://www.github.com/iotaledger/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M29.059 35.574c.597-.144 1.222-.277 1.84-.445 2.449-.672 4.699-1.742 6.542-3.582 1.868-1.871 2.891-4.164 3.106-6.828.207-2.5-.121-4.922-1.211-7.196a11.407 11.407 0 0 0-.816-1.402c-.293-.437-.633-.84-.938-1.238.832-2.145.93-4.293-.027-6.403-.508-1.113-.332-.937-1.473-.82-2.36.242-4.344 1.32-6.016 3.031a.385.385 0 0 1-.328.082c-2.222-.718-4.511-.875-6.82-.777-1.605.066-3.184.3-4.715.84-.082.027-.238-.043-.312-.117-1.442-1.504-3.149-2.516-5.172-2.934-.496-.105-1.012-.117-1.516-.183-.21-.024-.328.066-.437.238-.73 1.144-.989 2.414-.977 3.754.016 1.176.191 2.316.816 3.351-.046.059-.093.125-.148.184-1.773 1.96-2.73 4.293-2.988 6.945-.2 2.09-.02 4.125.797 6.07 1.039 2.477 2.82 4.231 5.097 5.497 1.668.925 3.457 1.496 5.313 1.859.105.02.21.047.34.074-.477.996-.52 2.04-.559 3.09 0 .098-.074.242-.152.277-2.176.989-5.508.059-6.895-1.914-.117-.168-.219-.347-.332-.515-.828-1.246-1.93-2.07-3.414-2.27a2.62 2.62 0 0 0-.918.07c-.441.106-.512.383-.21.743.124.144.257.293.417.394 1.176.793 1.906 1.95 2.457 3.235.352.82.77 1.578 1.395 2.207 1.37 1.379 3.043 2.023 4.933 2.05.895.012 1.79-.113 2.711-.18-.004-.027.012.012.012.048 0 1.078.02 2.16-.008 3.238-.015.723-.36 1.297-.941 1.7-.407.28-.844.323-1.317.155C8.165 45.07 2.16 38.04.473 29.477-1.81 17.895 4.332 6.203 15.012 1.793c12.375-5.11 26.394 1.07 31.312 13.805 4.094 10.593.485 22.765-8.672 29.261a24.093 24.093 0 0 1-5.812 3.032c-.664.242-1.219.07-1.695-.43-.422-.445-.614-.992-.61-1.621.004-2.27.012-4.543-.004-6.817a23.91 23.91 0 0 0-.148-2.363c-.043-.367-.211-.719-.324-1.086Zm0 0"></path></svg><div class="social__title">GitHub</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#4B576F" href="https://discord.iota.org/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M7.16 32.832c.863 1.098 1.953 1.938 3.063 2.762 1.629 1.203 3.418 2.113 5.308 2.82.32.121.406.203.16.508-.472.578-.906 1.195-1.351 1.797-.117.164-.246.265-.465.246-5.21-.473-9.824-2.258-13.504-6.125-.27-.281-.394-.535-.367-.973.277-4.316.953-8.562 2.082-12.734.941-3.485 2.195-6.84 3.941-10.012.535-.973 1.418-1.45 2.282-1.976 2.332-1.418 4.832-2.434 7.52-2.946a12.73 12.73 0 0 1 1.01-.148c.579-.063.958.25 1.048.836.047.297-.219.226-.336.254-1.192.293-2.36.664-3.492 1.144-2.215.938-4.192 2.246-5.973 3.914 10.59-5.46 21.16-5.48 31.723.031.066-.238-.153-.289-.262-.39-2.5-2.274-5.445-3.711-8.692-4.567-.015-.003-.03-.003-.046-.007-.813-.207-.895-.496-.356-1.16.133-.16.262-.094.414-.083 2.063.16 4 .782 5.88 1.61 1.187.523 2.308 1.168 3.429 1.824.984.574 1.636 1.375 2.152 2.371 1.793 3.477 3.055 7.137 3.965 10.93a65.288 65.288 0 0 1 1.555 9.672c.05.578.02 1.164.14 1.73.063.278-.148.403-.289.559-2.691 2.937-6.058 4.695-9.879 5.656-1.226.305-2.472.46-3.722.59-.246.023-.371-.106-.5-.281-.43-.59-.856-1.192-1.32-1.758-.235-.29-.192-.383.148-.512 2.234-.832 4.308-1.957 6.168-3.465.789-.644 1.586-1.289 2.207-2.113.043-.031.144-.035.094-.11-.04-.058-.11-.015-.149.044-1.105.671-2.176 1.39-3.336 1.972-2.875 1.438-5.918 2.297-9.101 2.672-1.625.188-3.254.313-4.887.273-4.79-.113-9.39-1.003-13.629-3.355-.875-.488-1.715-1.039-2.57-1.562a2.344 2.344 0 0 1-.118-.09c-.035-.024-.07-.051-.105-.07-.004-.005-.031.03-.047.046.043.02.082.035.121.055l.086.121Zm20.09-7.16c-.02.715.168 1.387.45 2.031 1.093 2.512 4.116 3.102 5.964 1.168 1.793-1.875 1.598-5.172-.402-6.808a3.465 3.465 0 0 0-4.38.015c-1.128.934-1.589 2.168-1.632 3.594Zm-10.336-4.379c-.695-.031-1.316.172-1.887.543-2.293 1.48-2.64 5.086-.687 7.078 1.445 1.473 3.598 1.484 5.055.027 1.363-1.367 1.722-3.613.832-5.398-.68-1.367-1.739-2.195-3.313-2.25Zm0 0"></path></svg><div class="social__title">Discord</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#6A768E" href="https://www.twitter.com/iota/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M42.691 14.664c.032.383.032.762.032 1.145 0 11.597-9.356 24.964-26.45 24.964-5.265 0-10.156-1.441-14.273-3.941.75.082 1.469.11 2.246.11 4.344 0 8.344-1.387 11.54-3.75-4.087-.079-7.513-2.606-8.692-6.083a12.91 12.91 0 0 0 1.754.133c.836 0 1.672-.105 2.449-.297-4.262-.816-7.457-4.347-7.457-8.613v-.105a9.858 9.858 0 0 0 4.203 1.113c-2.504-1.578-4.145-4.266-4.145-7.309a8.36 8.36 0 0 1 1.266-4.43c4.578 5.325 11.457 8.805 19.168 9.184a9.343 9.343 0 0 1-.23-2.012C24.102 9.938 28.246 6 33.398 6c2.676 0 5.094 1.059 6.79 2.77a18.983 18.983 0 0 0 5.902-2.118c-.692 2.04-2.16 3.75-4.086 4.836a19.553 19.553 0 0 0 5.351-1.36 19.283 19.283 0 0 1-4.664 4.536Zm0 0"></path></svg><div class="social__title">Twitter</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#7D89A1" href="https://www.reddit.com/r/iota/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M41.52 18.086a4.98 4.98 0 0 0-3.551 1.492c-3.348-2.316-7.86-3.808-12.856-3.969L27.711 3.91l8.27 1.856a3.68 3.68 0 0 0 3.675 3.675c2.063 0 3.719-1.695 3.719-3.722A3.728 3.728 0 0 0 39.656 2c-1.445 0-2.691.871-3.312 2.063l-9.13-2.028c-.46-.12-.91.207-1.03.668l-2.852 12.899c-4.957.207-9.422 1.695-12.777 4.011a4.993 4.993 0 0 0-3.602-1.527c-5.21 0-6.918 6.992-2.144 9.383a10.574 10.574 0 0 0-.247 2.316c0 7.856 8.852 14.223 19.72 14.223 10.91 0 19.761-6.367 19.761-14.223 0-.785-.086-1.613-.293-2.351 4.68-2.403 2.953-9.348-2.23-9.348Zm-29.145 9.883a3.706 3.706 0 0 1 3.719-3.723c2.027 0 3.676 1.649 3.676 3.723a3.678 3.678 0 0 1-3.676 3.672c-2.063.011-3.719-1.649-3.719-3.672Zm20.09 8.765c-3.414 3.41-13.043 3.41-16.453 0-.375-.328-.375-.91 0-1.285a.902.902 0 0 1 1.238 0c2.605 2.672 11.25 2.719 13.969 0a.897.897 0 0 1 1.234 0c.387.375.387.957.012 1.285Zm-.074-5.082a3.682 3.682 0 0 1-3.676-3.675c0-2.063 1.648-3.723 3.676-3.723a3.706 3.706 0 0 1 3.718 3.723c-.007 2.015-1.656 3.675-3.718 3.675Zm0 0"></path></svg><div class="social__title">Reddit</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#8995AD" href="https://www.linkedin.com/company/iotafoundation/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M33.352 41.984v-.539c0-3.89.02-7.78-.012-11.672-.008-.984-.09-1.98-.274-2.945-.355-1.89-1.414-2.777-3.261-2.867-1.192-.055-2.301.187-3.16 1.125-.73.797-1.047 1.8-1.157 2.871a25.416 25.416 0 0 0-.125 2.441c-.011 3.704-.004 7.407-.004 11.11V42h-7.117V17.977h6.836v3.191c.027.008.055.012.082.02.059-.079.125-.149.176-.231 1.23-2.05 3.055-3.145 5.3-3.492 1.614-.25 3.212-.102 4.774.41 2.246.734 3.613 2.367 4.336 4.656.527 1.668.719 3.395.73 5.137.028 4.695.02 9.387.024 14.078 0 .066-.008.133-.016.238h-7.132ZM6.605 17.98H13.7v24.016H6.605V17.98Zm7.668-7.66c.004 2.407-1.84 4.34-4.136 4.34-2.293 0-4.145-1.945-4.137-4.344C6.008 7.93 7.84 6.008 10.121 6c2.297-.008 4.149 1.918 4.152 4.32Zm0 0"></path></svg><div class="social__title">LinkedIn</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#99A5BD" href="https://www.instagram.com/iotafoundation/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="social__icon"><path d="M15.559 0h17c.66.059 1.32.125 1.976.168 3.387.227 6.524 1.094 9.113 3.437 2.922 2.641 4.196 6.063 4.262 9.864.125 7.047.11 14.094.004 21.14-.05 3.356-1.078 6.461-3.406 9.02-2.625 2.894-6.02 4.184-9.797 4.25-7.102.125-14.211.2-21.309-.012-7.48-.215-12.25-4.832-13.12-12.23C.16 34.609.093 33.574 0 32.543V15.551c.059-.684.137-1.371.168-2.055C.535 5.984 5.016 1.164 12.473.281 13.496.156 14.527.094 15.559 0Zm8.55 4.492c-3.367 0-6.734-.066-10.097.024-2.64.07-5.13.71-7.051 2.742-1.828 1.93-2.395 4.328-2.453 6.847-.11 4.965-.153 9.93-.145 14.899 0 2.21.074 4.433.313 6.633.441 4.07 2.855 6.75 6.703 7.597a15.9 15.9 0 0 0 3.098.368c4.726.078 9.453.144 14.183.136 2.32-.004 4.652-.07 6.957-.316 4.5-.484 7.348-3.344 7.832-7.848.239-2.195.309-4.422.309-6.633.004-4.964.004-9.933-.156-14.898-.196-6.094-3.454-9.32-9.559-9.531-3.309-.114-6.621-.02-9.934-.02Zm0 0"></path><path d="M11.707 24.047c0-6.863 5.508-12.356 12.39-12.348 6.817.008 12.313 5.516 12.313 12.348 0 6.863-5.508 12.351-12.39 12.348-6.817-.012-12.313-5.52-12.313-12.348Zm12.39 8.012c4.4-.02 7.985-3.633 7.977-8.032-.008-4.398-3.617-7.992-8.015-7.996-4.43 0-8.047 3.64-8.02 8.07.031 4.395 3.656 7.973 8.059 7.958ZM39.79 11.191a2.881 2.881 0 0 1-2.892 2.91 2.897 2.897 0 0 1-2.89-2.914 2.881 2.881 0 0 1 2.855-2.863c1.625-.015 2.918 1.25 2.926 2.867Zm0 0"></path></svg><div class="social__title">Instagram</div></a></div></div>
<script src="/assets/js/runtime~main.000c6006.js"></script>
<script src="/assets/js/main.111cab16.js"></script>
</body>
</html>